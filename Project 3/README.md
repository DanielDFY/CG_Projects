# **Project3** 三维场景漫游

### 文件说明

* `3DWalker.html` : 主页面。
* `3DWalker.js` : 项目逻辑主体，包含：
  *  `Camera`（相机类，使用静态方法控制镜头移动、旋转）。
  * `KeyController`（键盘控制器类，初始化相机后使用静态方法绑定对键盘事件的监听及处理）。
  *  `TextureLoader`（纹理渲染类，根据参数创建并初始化使用纹理的场景对象，通过 `render`方法进行渲染，同时也受光照影响 ）。
  * `ObjectLoader` (模型渲染类，根据参数加载并初始化模型对象，通过 `render` 方法进行渲染，受光照影响，可实现附加动画效果)。
  *  `printMessage` 方法，打印当前相机位置及视角信息。
  * `main` 方法，执行逻辑主体。
* `scene.js` : 配置文件，包含场景中需要展示的模型、贴图、相机参数及光照信息。
* `MyVector3.js` : 向量方法库，包含了所需使用的三维向量运算函数。
* `objLoader.js` : 模型读取方法库，包含了所需使用的 `obj` 文件信息获取函数。
* `lib` 文件夹：提供的WebGL工具函数。
* `model` 文件夹 : 提供所需展示模型的 `obj` 文件。
* `image` 文件夹：包含所需纹理图片。



### 开发及运行环境

* 编辑器：Visual Studio Code
* 浏览器：Chrome (需关闭安全模式以读取本地模型、纹理文件)



### 运行方法

用支持`html5` 与 `WebGL` 的浏览器直接打开 `3DWalker.html` 。`WASD `分别控制前进、左移、后退、右移，`IJKL` 分别控制视线抬升、左旋、下降、右旋，`F` 键按下时打开摄像机所在处的点光源，松开时关闭光源(默认关闭)。



### 项目亮点

* 场景渲染流畅。
* 在实现纹理的基础上添加了对光照效果的支持。
* 代码中对场景内的不同对象实现了一定的抽象封装，逻辑清晰，可读性好。



### 所遇问题及解决方法

* 由于纹理图片体积较大，在其载入网页时所需时间较长，且为异步实现，WebGL会在短时间内无法正确加载纹理。

  解决方法：在加载纹理图片前预先加载一个1x1像素大小的 `PlaceHolder` ：

  ```Javas
  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE,new Uint8Array([0, 0, 0, 255]));
  ```

  当纹理图片载入完成后将其更换为所需纹理图片。



### 缺点和不足

* 未来可增加雾化、阴影及对 `Phong Shading` 的支持。
